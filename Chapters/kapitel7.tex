\section{Numerisches Lösen von DGL}

\subsection{Das Euler Verfahren}
DGL 1. Ordnung mit Anfangswert:
\begin{equation*}
    \tikzmark{a}\dot{x} = f(\tikzmark{b}t,x), \hspace{1em} x(0)=x_0
\end{equation*}
\begin{center}
    \begin{tikzpicture}[overlay,remember picture]
        \node at (-4,0) (ta) {Steigung};
        \node[right] at (-2,0) (tb) {Entspricht Funktion $f$ der gesuchten Variable $x$};
        \draw[->] (ta) [in=-90]to (a);
        \draw[->] (tb) [in=-90,out=100]to (b);
    \end{tikzpicture}
\end{center}
Idee: Immer nur ein Schritt auf einmal.
\begin{center}
    \begin{tikzpicture}
        \draw (-1,0) -- (0,0) -- (0,-1);
        \draw[<->] (6,0) node[below] {$t$} -- (0,0) -- (0,3) node[left] {$x$};
        \draw[thick] (0,1) node[left] {$x_0$} -- ++ (3,0) -- ++ (0,1)
        node[midway, right] {$\Delta x$}   -- (0,1);
        \draw (3,-0.1) node[below] {$t_1$} -- (3,0.1);
        \draw (0.1,2)  -- (-0.1,2) node[left] {$x_1$};
        \node[below] at (1.5,0) {$\Delta t = h$};
        \node at ( 7,2) {$\dfrac{\Delta x}{h} = f(t,x_0)$};
    \end{tikzpicture}
\end{center}
Explizites Euler Verfahren:
\begin{equation*}
    \boxed{
        x_{n+1} = x_n + h\cdot f\left( t_n,x_n \right)
    }
\end{equation*}
Implizites Euler Verfahren:
\begin{equation*}
    \boxed{
        x_{n+1} = x_n + h\cdot f\left( t+h,x_{n+1} \right)
    }
\end{equation*}

\bsp{Beispiel:}
Gegeben ist die DGL
\begin{equation*}
    \dot{x} = x^2+2t\cdot x, \hspace{1em} x_0 = 2
\end{equation*}
Nicht linear und nicht separierbar $\Rightarrow$ numerisch lösen.

Expliziter Euler mit Schrittweite $h=1$:
\begin{eqnarr}
    \dot{x} &=&  f(t,x) \\
    &=&  x^2+2t\cdot x\\
    &\Rightarrow&\\
    x_{n+1} &=& x_n + h\cdot \left( x_n^2+2t_n\cdot x_n \right)\\
    x_{1} &=& x_0 + h\cdot \left( x_0^2+2t_0\cdot x_0 \right)\\
    &=& 2 + 1\cdot \left( 2^2+2\cdot 0 \cdot 2 \right)\\
    &=& 6\\
    x_2 &=&  x_1 + h\cdot \left( x_1^2+2t_1\cdot x_1 \right)\\
    &=& 6 + 1\cdot\left( 6^2+2\cdot 1\cdot 6 \right)\\
    &=& 54\\
    \text{usw.}&&\\
\end{eqnarr}

\subsection{Runge-Kutta Verfahren}
\subsubsection{Runge-Kutta 2}
(Mittelpunktsregel)
\begin{eqnarr}
    x_{n+\frac{1}{2}} &=&  x_n + \frac{h}{2}\cdot f\left( t_n,x_{n} \right)\\
    x_{n+1} &=& x_n + h\cdot f\left(t_n+\frac{h}{2},x_{n+\frac{1}{2}}\right)\\
\end{eqnarr}
\begin{center}
    \begin{tikzpicture}
    \begin{axis}[
        width = 10cm,
        height = 5cm,
        axis lines = middle,
        clip = false,
        xmin = 0,
        xmax = 6,
        ymin = 0,
        ymax = 6, 
        restrict y to domain=0:6,
        ticks=none,
        xlabel = $t$,
        ylabel = $x$,
    ]

    \addplot+[mark=none,samples=50,domain=0:6 ] {x^2/3}
    node[pos=0.9,below right] {$x=\dfrac{1}{3}t^2$};
    \addplot[mark=none,samples=5,domain=1.5:2.5 ] {4*x/3-4/3};
    \addplot[mark=none,samples=5,domain=0:6 ] {4*x/3};

    \draw (axis cs:2,0.1) -- ++(axis cs:0,-0.2) node[below] {$t_{n+\frac{1}{2}}$};
    \draw (axis cs:4,0.1) -- ++(axis cs:0,-0.2) node[below] {$t_n$};
    
\end{axis}
    \end{tikzpicture}
\end{center}

\subsubsection{Runge Kutta 4}
(Klassisches Runge Kutta)
\begin{eqnarr}
    x_{A} &=&  x_n + \frac{h}{2}\cdot f\left( t_n,x_{n} \right)\\
    x_{B} &=&  x_n + \frac{h}{2}\cdot f\left( t_n+\frac{h}{2},x_{A} \right)\\
    x_{C} &=&  x_n + h\cdot f\left( t_n+\frac{h}{2},x_{B} \right)\\
    x_{n+1} &=& x_n + \frac{h}{6}\cdot \left( 
        f\left( t_n,x_{n} \right) + 2\cdot \left( 
        f\left( t_n+\frac{h}{2},x_{A} \right) \right.\right. +\\
        && \left.\left.   f\left( t_n+\frac{h}{2},x_{B} \right)
        \right) +
            f\left( t_n+h,x_{C} \right)
    \right)
\end{eqnarr}

\bsp{Beispiel:}

$\dot{x} = -x+\cos(t)$
\begin{center}
\begin{tikzpicture}
\begin{axis}[
        width = 10cm,
        height = 5cm,
        axis lines = middle,
        clip = false,
        xmin = 0,
        xmax = 2,
        ymin = -0.5,
        ymax = 1.5, 
        restrict y to domain=-4:7,
        ticks=none,
        xlabel = $t$,
        ylabel = $x$,
    ]

    \pgfmathdeclarefunction{ffunc}{2}{%
        \pgfmathparse{%
            -#2+sin(deg(#1))
        }%
    }
    \pgfmathdeclarefunction{xfunc}{1}{%
        \pgfmathparse{%
            exp(-#1) + sin(deg(#1))/2-cos(deg(#1))/2
        }%
    }

    \addplot+[mark=none,samples=50,domain=0:2 ] {xfunc(x)};
    %node[pos=0.5,below right] {$x=\sin(t)+2$};
    \addplot[mark=none,samples=5,domain=0:0.75] {ffunc(0,0.5)*x+0.5}
    node[right] (xa) {$x_A$};
    \addplot[mark=none,samples=5,domain=0:0.75] {ffunc(0.75,0.125)*x+0.5}
    node[right] (xb) {$x_B$};
    \addplot[mark=none,samples=5,domain=0:1.5] {ffunc(0.75,0.917479)*x+0.5}
    node[right] {$x_C$};
    \addplot[mark=none,samples=5,domain=0:1.5] {0.165*x+0.5}
    node[above right] {$x_1$};
    %\addplot[mark=none,samples=5,domain=0:4] {
        %4/6*(1.5*cos(deg(1.5*2)))
    %*x+2}
    %node[right] {$x_C$};

    \draw (axis cs:0.75,0.1) -- (axis cs:0.75,-0.1) node[below] {$t_{n+\frac{1}{2}}$};
    \draw (axis cs:1.5,0.1) -- (axis cs:1.5,-0.1) node[below] {$t_n$};
    
\end{axis}
\end{tikzpicture}
\end{center}

\subsection{Fehler}
Numerische Verfahren sind \underline{immer} Fehlerbehaftet
\begin{outline}
    \1 Rundungsfehler (z.B. Maschinenzahlen)
    \1 Diskretisierungsfehler
\end{outline}
\textbf{Absoluter Fehler:}
\begin{equation*}
    e_{\text{abs}} = \left| x_{\text{num}} - x_{\text{exakt}} \right|
\end{equation*}
\textbf{Relativer Fehler:}
\begin{equation*}
    e_{\text{rel}} = \left| \frac{x_{\text{num}} - x_{\text{exakt}}}
                            {x_{\text{num}}}\right|
\end{equation*}
\bsp{Beispiel Euler Verfahren}
\begin{center}
\begin{tikzpicture}
    \draw (-1,0) -- (0,0) -- (0,-1);
    \draw[<->] (6,0) -- (0,0) -- (0,3);
    \draw (0.1,1) -- ++ (-0.1,0) node[left] {$x_0$};
    \draw (2.5,0.1) -- ++ (0,-0.1) node[below] {$h$};
    \draw (5,0.1) -- ++ (0,-0.1) node[below] {$2h$};

    \draw[dotted] (0,1) 
                to[out=10,in=160] (2,0.5) 
                to[out=-20,in=180] (3,1)
                to[out=0,in=180] (4,0.4)
                to[out=0,in=200] (6,2) ;

    \draw (0,1) -- (2.5,2);
\end{tikzpicture}
\end{center}

\subsection{Differentialgleichungssysteme}
\subsection{Matlab ode}
